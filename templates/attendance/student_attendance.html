{% extends "components/base.html" %}
{% load static %}
{% block title %}Asistencia de Estudiantes | SchoolHub{% endblock %}

{% block content %}
<div class="space-y-6">
    <!-- Header Section -->
    <div class="flex justify-between items-center">
        <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 text-transparent bg-clip-text">
            Asistencia a Clase
        </h1>
    </div>

    <!-- Students Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for stats in students_attendance %}
        <div class="glass-effect rounded-xl p-6 shadow-lg hover-scale">
            <!-- Student Info Header -->
            <div class="flex items-center space-x-4 mb-4">
                <img src="{{ '/static/img/9334176.jpg' }}" 
                     class="w-16 h-16 rounded-full object-cover border-2 border-blue-500"
                     alt="{{ stats.student.get_full_name }}">
                <div>
                    <h3 class="text-lg font-semibold text-gray-800">{{ stats.student.get_full_name }}</h3>
                    <p class="text-sm text-gray-600">{{ stats.student.grade }} - {{ stats.student.parallel }}</p>
                </div>
            </div>

            <!-- Attendance Overview -->
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-gray-600">Asistencia Total</span>
                    <span class="text-lg font-bold {% if stats.total_attendance >= 90 %}text-green-600{% elif stats.total_attendance >= 75 %}text-yellow-600{% else %}text-red-600{% endif %}">
                        {{ stats.total_attendance|floatformat:1 }}%
                    </span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2.5">
                    <div class="h-2.5 rounded-full {% if stats.total_attendance >= 90 %}bg-green-600{% elif stats.total_attendance >= 75 %}bg-yellow-600{% else %}bg-red-600{% endif %}"
                         style="width: {{ stats.total_attendance }}%"></div>
                </div>
            </div>

            <!-- Detailed Stats -->
            <div class="grid grid-cols-2 gap-4">
                <!-- Present Stats -->
                <div class="p-3 rounded-lg bg-green-100">
                    <div class="flex justify-between items-center">
                        <span class="text-sm font-medium text-green-800">{{ status_labels.present }}</span>
                        <span class="text-sm font-bold text-green-800">
                            {{ stats.percentages.present|floatformat:1 }}%
                        </span>
                    </div>
                    <div class="text-xs mt-1 text-green-600">
                        {{ stats.counts.present_count }} días
                    </div>
                </div>

                <!-- Absent Stats -->
                <div class="p-3 rounded-lg bg-red-100">
                    <div class="flex justify-between items-center">
                        <span class="text-sm font-medium text-red-800">{{ status_labels.absent }}</span>
                        <span class="text-sm font-bold text-red-800">
                            {{ stats.percentages.absent|floatformat:1 }}%
                        </span>
                    </div>
                    <div class="text-xs mt-1 text-red-600">
                        {{ stats.counts.absent_count }} días
                    </div>
                </div>

                <!-- Late Stats -->
                <div class="p-3 rounded-lg bg-yellow-100">
                    <div class="flex justify-between items-center">
                        <span class="text-sm font-medium text-yellow-800">{{ status_labels.late }}</span>
                        <span class="text-sm font-bold text-yellow-800">
                            {{ stats.percentages.late|floatformat:1 }}%
                        </span>
                    </div>
                    <div class="text-xs mt-1 text-yellow-600">
                        {{ stats.counts.late_count }} días
                    </div>
                </div>

                <!-- Justified Stats -->
                <div class="p-3 rounded-lg bg-blue-100">
                    <div class="flex justify-between items-center">
                        <span class="text-sm font-medium text-blue-800">{{ status_labels.justified }}</span>
                        <span class="text-sm font-bold text-blue-800">
                            {{ stats.percentages.justified|floatformat:1 }}%
                        </span>
                    </div>
                    <div class="text-xs mt-1 text-blue-600">
                        {{ stats.counts.justified_count }} días
                    </div>
                </div>
            </div>

            <!-- Total Days Info -->
            <div class="mt-4 text-center text-sm text-gray-600">
                <span class="font-medium">Total de días registrados:</span> {{ stats.total_days }}
            </div>
        </div>
        {% empty %}
        <div class="col-span-full text-center py-12">
            <div class="glass-effect rounded-xl p-8 max-w-lg mx-auto">
                <i class="fas fa-user-graduate text-4xl text-gray-400 mb-4"></i>
                <h3 class="text-xl font-semibold text-gray-700 mb-2">No hay estudiantes registrados</h3>
                <p class="text-gray-600">No se encontraron registros de asistencia para mostrar.</p>
            </div>
        </div>
        {% endfor %}
    </div>
</div>
{% endblock  %}
{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Agregamos animaciones de entrada
    const cards = document.querySelectorAll('.hover-scale');
    cards.forEach((card, index) => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        setTimeout(() => {
            card.style.transition = 'all 0.5s ease';
            card.style.opacity = '1';
            card.style.transform = 'translateY(0)';
        }, index * 100);
    });
});
</script>
{% endblock extra_js %}